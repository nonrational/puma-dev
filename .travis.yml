language: go

go_import_path: github.com/puma/puma-dev

go:
  - "1.13.x"
  - master

os:
  - linux
  - osx

install:
  - go get -t ./...

before_script:
  - if [ "$TRAVIS_OS_NAME" == "osx" ]; then
      sudo mkdir -p /etc/resolver;
      sudo chmod 0775 /etc/resolver;
      sudo chown :staff /etc/resolver;

      mkdir -p $HOME/Library/Application\ Support/io.puma.dev/;
      cp -rv ./etc/dummy-travis-ci-pki/* $HOME/Library/Application\ Support/io.puma.dev/;
    fi

script:
  - make test
